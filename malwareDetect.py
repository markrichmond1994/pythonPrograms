import sys

log_file = sys.argv[1]

rule1count = 0
rule2count = 0
rule3count = 0
filesCreated = []
filesDeleted = []

f = open(log_file, "r")
#loop through each line in log file
for x in f:
  #rule 1
  if x.find("File Rename: ScapeGoat\\") != -1:
    rule1count += 1
  #rule 2
  if x.find("File Modify: ScapeGoat\\") != -1:
    rule2count += 1
  #rule 3
  if x.find("File Create") != -1: #add created file names to array for checking
    y = x.split(": ")
    filesCreated.append(y[1])
  if x.find("File Delete") != -1: #add deleted file names to array for checking
    z = x.split(": ")
    filesDeleted.append(z[1])

#increment count for rule 3
for x in filesCreated:
    if x in filesDeleted:
        rule3count += 1

if rule1count >= 3 and rule2count >= 3 and rule3count >= 1:
    print "malware detected --> HEUR:TrojanRansom.DocxEncrypt.Generic"
else:
    print "No malware found."